# 사용자 시나리오
### 로그인 명세서 / 시퀀스 다이어그램
```
▶ 유스케이스명 : 로그인
▶ 액터명 : 고객
▶ 유스케이스 개요 및 설명 : 고객이 브라우저를 통해 로그인을 하는 시나리오이다.
▶ 사전 조건 : 로그인이 되어있지 않은 상태여야 한다.
▶ 이벤트 흐름
- 정상 흐름
(1) 로그인을 시도한다 (고객) (선택흐름 A)
(2) 회원 테이블에서 아이디와 비밀번호를 검색한다 (서버) (선택흐름 B)
(3) 로그인에 성공하면 쇼핑몰의 메인 페이지를 고객에게 보여준다 (서버)
- 선택흐름
A. 브라우저에서 아이디와 비밀번호의 유효성 검사
A-1. 아이디를 입력하지 않은 경우 '아이디를 입력해 주세요' 라는 메세지를 사용자에게 보여준다
A-2. 비밀번호를 입력하지 않은 경우 '비밀번호를 입력해 주세요' 라는 메세지를 사용자에게 보여준다
A-3. 공격에 사용될 수 있는 특수 문자나 한글을 입력한 경우 '올바른 형식이 아닙니다' 라는 메세지를 사용자에게 보여준다

B. 서버에서 아이디와 비밀번호의 유효성 검사
B-1. 아이디 파라미터가 비어있는 경우 '아이디를 입력해 주세요' 라는 메세지를 브라우저에 전송한다
B-2. 비밀번호 파라미터가 비어있는 경우 '비밀번호를 입력해 주세요' 라는 메세지를 브라우저에 전송한다
B-3. 공격에 사용될 수 있는 특수 문자나 한글을 입력한 경우 '올바른 형식이 아닙니다' 라는 메세지를 브라우저에 전송한다
B-4. 회원 테이블에 아이디와 비밀번호가 일치하는 정보가 없다면 '계정이 존재하지 않습니다' 라는 메세지를 브라우저에 전송한다
```
![123](https://user-images.githubusercontent.com/20277647/60804071-9efd5380-a1b7-11e9-9bfd-af04f1de89b4.PNG)

### 회원가입 명세서 / 시퀀스 다이어그램
```
▶ 유스케이스명 : 회원가입
▶ 액터명 : 고객
▶ 유스케이스 개요 및 설명 : 고객이 브라우저를 통해 회원가입을 하는 시나리오이다.
▶ 사전 조건 : 로그인 및 회원가입이 되어있지 않은 상태여야 한다.
▶ 이벤트 흐름
- 정상 흐름
(1) 회원가입을 시도한다 (고객)
(2) 약관 페이지를 보여준다 (브라우저) (선택흐름 A)
(3) 회원가입에 필요한 정보들을 입력한다 (고객)
(4) 아이디 중복 여부를 체크한다 (서버) (선택흐름 B)
(5) 회원가입 버튼을 누른다 (고객) (선택흐름 C)
(6) 고객이 입력한 회원 정보를 데이터베이스에 저장한다 (서버) (선택흐름 D)
(7) 회원가입이 성공했다는 메세지와 함께 브라우저를 로그인 페이지로 이동 시킨다 (서버)
- 선택흐름
A. 고객의 약관 동의 여부
A-1. 고객이 회원가입시 약관에 동의하지 않은 경우 '약관에 동의하지 않을 경우 회원가입을 하실 수 없습니다' 라는 메세지를 고객에게 보여준다

B. 아이디 중복 검사
B-1. 아이디가 존재하는 경우 '이미 존재하는 아이디 입니다' 라는 메세지를 브라우저에 전송한다
B-2. 아이디가 존재하지 않는 경우 체크 표시를 통해 사용 가능한 아이디라는 것을 사용자에게 알려준다
B-3. 아이디에 대해 공격에 사용될 수 있는 특수 문자나 한글 등을 입력한 경우 '아이디의 형식이 올바르지 않습니다' 라는 메세지를 사용자에게 보여준다

C. 브라우저에서 회원가입 입력값에 대한 유효성 검사
C-1. 아이디, 비밀번호, 이름, 주소, 휴대폰 번호, 이메일, 생년월일, 환불 계좌 은행, 환불 계좌 번호 가 입력되어 있지 않으면 '필수 항목을 입력해 주세요' 라는 메세지를 사용자에게 보여준다
C-2. 모든 입력 항목들에 대해 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '~~ 의 형식이 올바르지 않습니다' 라는 메세지를 사용자에게 보여준다

D. 서버에서 회원가입 입력값에 대한 유효성 검사
D-1. 아이디, 비밀번호, 이름, 주소, 휴대폰 번호, 이메일, 생년월일, 환불 계좌 은행, 환불 계좌 번호 가 입력되어 있지 않으면 '필수 항목을 입력해 주세요' 라는 메세지를 브라우저에 전송한다
D-2. 모든 입력 항목들에 대해 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '~~ 의 형식이 올바르지 않습니다' 라는 메세지를 브라우저에 전송한다
```
![123](https://user-images.githubusercontent.com/20277647/60805789-1fbe4e80-a1bc-11e9-84e3-728b7e667c91.PNG)

### 상품 리스트 조회 명세서 / 시퀀스 다이어그램
```
▶ 유스케이스명 : 상품 리스트 조회
▶ 액터명 : 고객
▶ 유스케이스 개요 및 설명 : 고객이 쇼핑몰의 카테고리 혹은 검색을 통해 구입할 상품의 리스트를 살펴볼 수 있는 시나리오이다.
▶ 사전 조건 : 카테고리를 선택 하거나 검색 창에 검색한다.
▶ 이벤트 흐름
- 정상 흐름
(1) 원하는 항목의 카테고리를 클릭한다 (고객) (선택흐름 A)
(2) 상품 관리 테이블에서 진열 여부가 True이고, 상품 카테고리 테이블에서 사용자가 요청한 카테고리에 맞는 상품들의 리스트를 고객에게 보여준다 (서버)
(3) 검색창을 통해 상품을 검색한다 (고객) (선택흐름 B)
(4) 상품 관리 테이블에서 진열 여부가 True이고, 상품 테이블에서 상품명, 상품 요약 설명에 대해 검색어가 들어가 있거나, 상품 카테고리에 검색어가 들어가 있는 상품들의 리스트를 고객에게 보여준다 (서버)
- 선택흐름
A. 카테고리 유효성 검사
A-1. 서버에 전송되는 카테고리에 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '카테고리의 형식이 올바르지 않습니다' 라는 메세지를 브라우저에 전송한다

B. 검색어 유효성 검사
B-1. 브라우저에서 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '검색어의 형식이 올바르지 않습니다' 라는 메세지를 고객에게 보여준다
B-2. 서버에서 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '검색어의 형식이 올바르지 않습니다' 라는 메세지를 브라우저에 전송한다
```
![123](https://user-images.githubusercontent.com/20277647/60807026-8ee97200-a1bf-11e9-95ee-29d706e13b45.PNG)

### 상품 상세 조회 명세서 / 시퀀스 다이어그램
```
▶ 유스케이스명 : 상품 상세 조회
▶ 액터명 : 고객
▶ 유스케이스 개요 및 설명 : 고객이 상품의 상세 조회를 할 수 있는 시나리오이다.
▶ 사전 조건 : 상품 리스트에서 자세히 보기를 원하는 상품을 클릭한 상태여야 한다.
▶ 이벤트 흐름
- 정상 흐름
(1) 상품의 상세한 정보를 보기 위해 상품 리스트에서 하나의 상품을 클릭한다 (고객) (선택흐름 A)
- 선택흐름
A. 상품 상세조회 유효성 검사
A-1. 상품의 번호가 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '존재하지 않는 상품입니다' 라는 메세지를 브라우저에 전송한다
```
![123](https://user-images.githubusercontent.com/20277647/60807349-64e47f80-a1c0-11e9-81b6-ef87d1557a91.PNG)

### 장바구니 관리 명세서 / 시퀀스 다이어그램
```
▶ 유스케이스명 : 장바구니 관리
▶ 액터명 : 고객
▶ 유스케이스 개요 및 설명 : 고객이 상품을 장바구니에 담을 수 있는 시나리오이다.
▶ 사전 조건 : 상품 상세 조회에서 특정한 상품에 대해 장바구니 담기 버튼을 클릭한 상태이다.
▶ 이벤트 흐름
- 정상 흐름
(1) 상품 옵션을 선택한다 (고객)
(2) 장바구니 담기 버튼을 클릭한다 (고객)
(3) 장바구니 정보를 데이터베이스에 저장한다 (서버) (선택흐름 A)
(4) 장바구니 내에서 구매할 물품의 수량을 변경한다 (고객) (선택흐름 B)
(5) 변경된 수량 정보를 데이터베이스에 저장한다 (서버) (선택흐름 A-4, C-2)
(6) 장바구니 내에서 구매할 물품의 옵션을 변경한다 (고객)
(7) 변경된 물품 옵션의 정보를 데이터베이스에 저장한다 (서버) (선택흐름 A-3, C-2)
(8) 장바구니 아이콘을 클릭하여 장바구니를 조회한다 (고객)
(9) 일부 항목들을 장바구니에서 삭제한다 (고객) (선택흐름 C)
(10) 장바구니 비우기 버튼을 통해 장바구니에 담아져 있는 전체 물품을 삭제한다 (고객) (선택흐름 C)
- 선택흐름
A. 장바구니 담기 유효성 검사
A-1. 회원인 경우 서버에 넘어오는 회원 아이디의 값이 올바른지 확인하고 올바르지 않다면 '세션이 만료되었습니다' 라는 메세지를 브라우저에 전송한 후 로그인 페이지로 이동 시킨다
A-2. 상품의 번호가 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '존재하지 않는 상품입니다' 라는 메세지를 브라우저에 전송한다
A-3. 상품 옵션 번호가 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '존재하지 않는 상품입니다' 라는 메세지를 브라우저에 전송한다
A-4. 서버에 전달되는 수량이 숫자가 아니거나 공격에 사용될 수 있는 특수 문자 등을 입력한 경우 '수량이 잘못 되었습니다' 라는 메세지를 브라우저에 전송한다

B. 물품의 수량 확인
B-1. 상품 수량을 증가할 경우 상품 옵션 상세 테이블에서 판매 가능 수량이 0보다 큰지 확인한다

C. 장바구니 삭제 유효성 검사
C-1. 삭제할 때 넘어오는 장바구니 번호의 값이 유효한티 검증한다
C-2. 회원인 경우 회원 아이디가 같은지, 비회원인 경우 동일 아이피에서 삭제를 요청하는지 검사한다
```
![123](https://user-images.githubusercontent.com/20277647/60816103-ee517d00-a1d3-11e9-89b5-27c59acdee7e.PNG)

### 주문 명세서 / 시퀀스 다이어그램
```
▶ 유스케이스명 : 주문
▶ 액터명 : 고객
▶ 유스케이스 개요 및 설명 : 고객이 장바구니에 담긴 물품 혹은 물품 상세 정보에서 주문을 하는 시나리오이다.
▶ 사전 조건 : 장바구니 조회 페이지 혹은 상품 상세 조회 페이지에서 주문하기 버튼을 누른 경우
▶ 이벤트 흐름
- 정상 흐름
(1) 주문하기 버튼을 클릭한다 (고객)
(2) 상품의 재고를 확인한다 (서버) (선택흐름 A)
(2) 주문할 물품들의 정보와 주문 작성 페이지를 보여준다 (브라우저)
(3) 배송지 받는 사람, 배송지 주소, 배송 메세지(선택사항)를 입력하고, 결제 수단을 선택한다 (고객) (선택흐름 B)
(4) 주문 완료 버튼을 클릭한다 (고객) (선택흐름 C)
(5) 결제 API를 통해 결제를 진행한다 (결제 API) (선택흐름 D)
(6) 결제 완료 페이지를 보여준다 (브라우저)
- 선택흐름
A. 상품 재고 확인
A-1. 상품의 재고가 주문하고자 하는 물품 수량보다 부족한 경우 '재고가 부족합니다' 라는 메세지를 브라우저에 전송한다
A-2. 상품 재고가 정상적으로 있는 경우 아직 주문 전이더라도 상품 옵션 상세 테이블의 재고 값을 미리 감소시켜 놓는다

B. 회원 비회원 유무
B-1. 만약 비회원일 경우에는 추가적으로 주문 조회 비밀번호, 이름, 휴대폰 번호, 환불 계좌 은행, 환불 계좌 번호를 입력하도록 한다
B-2. 만약 회원일 경우 마일리지 사용 여부를 확인한다

C. 주문 작성 페이지 유효성 검사 (브라우저, 서버 양쪽에서 검사)
C-1. 배송지 받는 사람에 악의적인 공격에 사용될 수 있는 특수 문자 등을 입력했는지 검사한다
C-2. 배송지 주소에 악의적인 공격에 사용될 수 있는 특수 문자 등을 입력했는지 검사한다
C-3. 배송 메세지에 악의적인 공격에 사용될 수 있는 특수 문자 등을 입력했는지 검사한다
C-4. 결제 수단이 올바른 값인지 검사한다
C-5. 회원, 비회원에 따른 추가 입력 사항들에 악의적인 공격에 사용될 수 있는 특수 문자 등을 입력했는지 검사한다

D. 결제 수단에 따른 분기
D-1. 즉시 결제하는 수단일 경우 결제 유효성을 검사하고 결제를 진행한다
D-2. 나중에 결제하는 수단일 경우 지정한 날짜까지 결제가 이루어지는지 기다린다
D-3. 이후 결제가 성공하면 주문 테이블의 입금 상태를 '입금완료'로 변경한다
D-4. 설정한 기한까지 결제가 이루어지지 않으면 재고를 다시 원상복구 한다
```
![123](https://user-images.githubusercontent.com/20277647/60820228-f9a8a680-a1db-11e9-887c-6e51c34c9fd2.PNG)

### 주문 내역 조회 명세서 / 시퀀스 다이어그램
```
▶ 유스케이스명 : 주문 내역 조회
▶ 액터명 : 고객
▶ 유스케이스 개요 및 설명 : 고객이 주문 내역을 조회하는 시나리오이다.
▶ 사전 조건 : 주문 내역 조회 버튼을 클릭한다
▶ 이벤트 흐름
- 정상 흐름
(1) 주문 내역 조회 버튼을 클릭한다 (고객)
(2) 주문 내역 조회 페이지를 보여준다 (서버) (선택흐름 A)
(3) 특정 주문에 대해 취소 혹은 교환 혹은 반품 혹은 환불을 선택한다
- 선택흐름
A. 회원 비회원 유무
A-1. 회원인 경우 회원 아이디와 주문 번호를 바탕으로 주문 내역 조회 페이지를 보여준다
A-2. 비회원인 경우 휴대폰 번호와 주문 조회 비밀번호를 입력하여 주문 내역 조회 페이지를 보여준다
```
![123](https://user-images.githubusercontent.com/20277647/60822926-5ce90780-a1e1-11e9-9074-3d844a1a53e3.PNG)